{
    "cells": [
        {
            "cell_type": "code",
            "execution_count": 1,
            "metadata": {},
            "outputs": [],
            "source": "import pandas as pd\nimport numpy as np"
        },
        {
            "cell_type": "markdown",
            "metadata": {
                "collapsed": true
            },
            "source": "# Importing Data"
        },
        {
            "cell_type": "code",
            "execution_count": 2,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/IPython/core/interactiveshell.py:3020: DtypeWarning: Columns (33) have mixed types. Specify dtype option on import or set low_memory=False.\n  interactivity=interactivity, compiler=compiler, result=result)\n"
                }
            ],
            "source": "df = pd.read_csv(\"https://s3.us.cloud-object-storage.appdomain.cloud/cf-courses-data/CognitiveClass/DP0701EN/version-2/Data-Collisions.csv\")"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "# Uncovering some flaws in the dataset"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Discovering Types and Number of Values"
        },
        {
            "cell_type": "code",
            "execution_count": 3,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 194673 entries, 0 to 194672\nData columns (total 38 columns):\nSEVERITYCODE      194673 non-null int64\nX                 189339 non-null float64\nY                 189339 non-null float64\nOBJECTID          194673 non-null int64\nINCKEY            194673 non-null int64\nCOLDETKEY         194673 non-null int64\nREPORTNO          194673 non-null object\nSTATUS            194673 non-null object\nADDRTYPE          192747 non-null object\nINTKEY            65070 non-null float64\nLOCATION          191996 non-null object\nEXCEPTRSNCODE     84811 non-null object\nEXCEPTRSNDESC     5638 non-null object\nSEVERITYCODE.1    194673 non-null int64\nSEVERITYDESC      194673 non-null object\nCOLLISIONTYPE     189769 non-null object\nPERSONCOUNT       194673 non-null int64\nPEDCOUNT          194673 non-null int64\nPEDCYLCOUNT       194673 non-null int64\nVEHCOUNT          194673 non-null int64\nINCDATE           194673 non-null object\nINCDTTM           194673 non-null object\nJUNCTIONTYPE      188344 non-null object\nSDOT_COLCODE      194673 non-null int64\nSDOT_COLDESC      194673 non-null object\nINATTENTIONIND    29805 non-null object\nUNDERINFL         189789 non-null object\nWEATHER           189592 non-null object\nROADCOND          189661 non-null object\nLIGHTCOND         189503 non-null object\nPEDROWNOTGRNT     4667 non-null object\nSDOTCOLNUM        114936 non-null float64\nSPEEDING          9333 non-null object\nST_COLCODE        194655 non-null object\nST_COLDESC        189769 non-null object\nSEGLANEKEY        194673 non-null int64\nCROSSWALKKEY      194673 non-null int64\nHITPARKEDCAR      194673 non-null object\ndtypes: float64(4), int64(12), object(22)\nmemory usage: 56.4+ MB\n"
                }
            ],
            "source": "df.info()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Counting Missing Values"
        },
        {
            "cell_type": "code",
            "execution_count": 4,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "SEVERITYCODE           0\nX                   5334\nY                   5334\nOBJECTID               0\nINCKEY                 0\nCOLDETKEY              0\nREPORTNO               0\nSTATUS                 0\nADDRTYPE            1926\nINTKEY            129603\nLOCATION            2677\nEXCEPTRSNCODE     109862\nEXCEPTRSNDESC     189035\nSEVERITYCODE.1         0\nSEVERITYDESC           0\nCOLLISIONTYPE       4904\nPERSONCOUNT            0\nPEDCOUNT               0\nPEDCYLCOUNT            0\nVEHCOUNT               0\nINCDATE                0\nINCDTTM                0\nJUNCTIONTYPE        6329\nSDOT_COLCODE           0\nSDOT_COLDESC           0\nINATTENTIONIND    164868\nUNDERINFL           4884\nWEATHER             5081\nROADCOND            5012\nLIGHTCOND           5170\nPEDROWNOTGRNT     190006\nSDOTCOLNUM         79737\nSPEEDING          185340\nST_COLCODE            18\nST_COLDESC          4904\nSEGLANEKEY             0\nCROSSWALKKEY           0\nHITPARKEDCAR           0\ndtype: int64"
                    },
                    "execution_count": 4,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "df.isna().sum()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Huge Unbalance"
        },
        {
            "cell_type": "code",
            "execution_count": 5,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "1    136485\n2     58188\nName: SEVERITYCODE, dtype: int64\n"
                }
            ],
            "source": "print(df['SEVERITYCODE'].value_counts())"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Counting Features Values"
        },
        {
            "cell_type": "code",
            "execution_count": 6,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Clear                       111135\nRaining                      33145\nOvercast                     27714\nUnknown                      15091\nSnowing                        907\nOther                          832\nFog/Smog/Smoke                 569\nSleet/Hail/Freezing Rain       113\nBlowing Sand/Dirt               56\nSevere Crosswind                25\nPartly Cloudy                    5\nName: WEATHER, dtype: int64\n"
                }
            ],
            "source": "print(df['WEATHER'].value_counts())"
        },
        {
            "cell_type": "code",
            "execution_count": 7,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Dry               124510\nWet                47474\nUnknown            15078\nIce                 1209\nSnow/Slush          1004\nOther                132\nStanding Water       115\nSand/Mud/Dirt         75\nOil                   64\nName: ROADCOND, dtype: int64\n"
                }
            ],
            "source": "print(df['ROADCOND'].value_counts())"
        },
        {
            "cell_type": "code",
            "execution_count": 8,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Daylight                    116137\nDark - Street Lights On      48507\nUnknown                      13473\nDusk                          5902\nDawn                          2502\nDark - No Street Lights       1537\nDark - Street Lights Off      1199\nOther                          235\nDark - Unknown Lighting         11\nName: LIGHTCOND, dtype: int64\n"
                }
            ],
            "source": "print(df['LIGHTCOND'].value_counts())"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "# Resampling"
        },
        {
            "cell_type": "code",
            "execution_count": 9,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "2    58188\n1    58188\nName: SEVERITYCODE, dtype: int64"
                    },
                    "execution_count": 9,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "from sklearn.utils import resample\n\ndf_maj = df[df.SEVERITYCODE == 1]\ndf_min = df[df.SEVERITYCODE == 2]\n\ndf_sample = resample(df_maj, replace=False, n_samples=58188, random_state=123)\ndf = pd.concat([df_sample, df_min])\n\ndf['SEVERITYCODE'].value_counts()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "# Converting"
        },
        {
            "cell_type": "code",
            "execution_count": 10,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>SEVERITYCODE</th>\n      <th>X</th>\n      <th>Y</th>\n      <th>OBJECTID</th>\n      <th>INCKEY</th>\n      <th>COLDETKEY</th>\n      <th>REPORTNO</th>\n      <th>STATUS</th>\n      <th>ADDRTYPE</th>\n      <th>INTKEY</th>\n      <th>...</th>\n      <th>ROADCOND</th>\n      <th>LIGHTCOND</th>\n      <th>PEDROWNOTGRNT</th>\n      <th>SDOTCOLNUM</th>\n      <th>SPEEDING</th>\n      <th>ST_COLCODE</th>\n      <th>ST_COLDESC</th>\n      <th>SEGLANEKEY</th>\n      <th>CROSSWALKKEY</th>\n      <th>HITPARKEDCAR</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>25055</th>\n      <td>1</td>\n      <td>-122.292730</td>\n      <td>47.719265</td>\n      <td>29626</td>\n      <td>43684</td>\n      <td>43684</td>\n      <td>1778514</td>\n      <td>Matched</td>\n      <td>Intersection</td>\n      <td>36599.0</td>\n      <td>...</td>\n      <td>Wet</td>\n      <td>Dark - Street Lights On</td>\n      <td>NaN</td>\n      <td>5022026.0</td>\n      <td>NaN</td>\n      <td>10</td>\n      <td>Entering at angle</td>\n      <td>0</td>\n      <td>0</td>\n      <td>N</td>\n    </tr>\n    <tr>\n      <th>65280</th>\n      <td>1</td>\n      <td>-122.329124</td>\n      <td>47.608658</td>\n      <td>71557</td>\n      <td>84514</td>\n      <td>84514</td>\n      <td>2623093</td>\n      <td>Matched</td>\n      <td>Intersection</td>\n      <td>29926.0</td>\n      <td>...</td>\n      <td>Dry</td>\n      <td>Daylight</td>\n      <td>NaN</td>\n      <td>8235027.0</td>\n      <td>NaN</td>\n      <td>10</td>\n      <td>Entering at angle</td>\n      <td>0</td>\n      <td>0</td>\n      <td>N</td>\n    </tr>\n    <tr>\n      <th>86292</th>\n      <td>1</td>\n      <td>-122.292434</td>\n      <td>47.733753</td>\n      <td>94574</td>\n      <td>110476</td>\n      <td>110476</td>\n      <td>3377452</td>\n      <td>Matched</td>\n      <td>Intersection</td>\n      <td>35987.0</td>\n      <td>...</td>\n      <td>Unknown</td>\n      <td>Unknown</td>\n      <td>NaN</td>\n      <td>10323017.0</td>\n      <td>NaN</td>\n      <td>10</td>\n      <td>Entering at angle</td>\n      <td>0</td>\n      <td>0</td>\n      <td>N</td>\n    </tr>\n    <tr>\n      <th>155111</th>\n      <td>1</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>172907</td>\n      <td>222604</td>\n      <td>222884</td>\n      <td>E554578</td>\n      <td>Matched</td>\n      <td>Block</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>Dry</td>\n      <td>Daylight</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>11</td>\n      <td>From same direction - both going straight - bo...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>N</td>\n    </tr>\n    <tr>\n      <th>64598</th>\n      <td>1</td>\n      <td>-122.339185</td>\n      <td>47.625594</td>\n      <td>70842</td>\n      <td>84273</td>\n      <td>84273</td>\n      <td>2898917</td>\n      <td>Matched</td>\n      <td>Block</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>Dry</td>\n      <td>Daylight</td>\n      <td>NaN</td>\n      <td>8069016.0</td>\n      <td>NaN</td>\n      <td>30</td>\n      <td>From opposite direction - all others</td>\n      <td>0</td>\n      <td>0</td>\n      <td>N</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows \u00d7 38 columns</p>\n</div>",
                        "text/plain": "        SEVERITYCODE           X          Y  OBJECTID  INCKEY  COLDETKEY  \\\n25055              1 -122.292730  47.719265     29626   43684      43684   \n65280              1 -122.329124  47.608658     71557   84514      84514   \n86292              1 -122.292434  47.733753     94574  110476     110476   \n155111             1         NaN        NaN    172907  222604     222884   \n64598              1 -122.339185  47.625594     70842   84273      84273   \n\n       REPORTNO   STATUS      ADDRTYPE   INTKEY  ... ROADCOND  \\\n25055   1778514  Matched  Intersection  36599.0  ...      Wet   \n65280   2623093  Matched  Intersection  29926.0  ...      Dry   \n86292   3377452  Matched  Intersection  35987.0  ...  Unknown   \n155111  E554578  Matched         Block      NaN  ...      Dry   \n64598   2898917  Matched         Block      NaN  ...      Dry   \n\n                      LIGHTCOND PEDROWNOTGRNT  SDOTCOLNUM SPEEDING ST_COLCODE  \\\n25055   Dark - Street Lights On           NaN   5022026.0      NaN         10   \n65280                  Daylight           NaN   8235027.0      NaN         10   \n86292                   Unknown           NaN  10323017.0      NaN         10   \n155111                 Daylight           NaN         NaN      NaN         11   \n64598                  Daylight           NaN   8069016.0      NaN         30   \n\n                                               ST_COLDESC  SEGLANEKEY  \\\n25055                                   Entering at angle           0   \n65280                                   Entering at angle           0   \n86292                                   Entering at angle           0   \n155111  From same direction - both going straight - bo...           0   \n64598                From opposite direction - all others           0   \n\n        CROSSWALKKEY  HITPARKEDCAR  \n25055              0             N  \n65280              0             N  \n86292              0             N  \n155111             0             N  \n64598              0             N  \n\n[5 rows x 38 columns]"
                    },
                    "execution_count": 10,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "df = df.astype({\"WEATHER\":'category', \"ROADCOND\":'category', \"LIGHTCOND\":'category'})\ndf.head()"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "# Label Encoding"
        },
        {
            "cell_type": "code",
            "execution_count": 11,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([[ 6,  8,  2],\n       [ 1,  0,  5],\n       [10,  7,  8],\n       ...,\n       [ 1,  0,  5],\n       [ 1,  0,  5],\n       [ 1,  0,  6]], dtype=int8)"
                    },
                    "execution_count": 11,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "df[\"WEATHER_c\"] = df[\"WEATHER\"].cat.codes\ndf[\"ROADCOND_c\"] = df[\"ROADCOND\"].cat.codes\ndf[\"LIGHTCOND_c\"] = df[\"LIGHTCOND\"].cat.codes\nFeature = df[['WEATHER','ROADCOND','LIGHTCOND','WEATHER_c','ROADCOND_c','LIGHTCOND_c']]\nX = np.asarray(Feature[['WEATHER_c','ROADCOND_c','LIGHTCOND_c']])\nX[0:]"
        },
        {
            "cell_type": "code",
            "execution_count": 12,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([1, 1, 1, ..., 2, 2, 2])"
                    },
                    "execution_count": 12,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "y = df['SEVERITYCODE'].values\ny[0:]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "# Modeling"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Normalizing Data"
        },
        {
            "cell_type": "code",
            "execution_count": 13,
            "metadata": {},
            "outputs": [
                {
                    "name": "stderr",
                    "output_type": "stream",
                    "text": "/opt/conda/envs/Python36/lib/python3.6/site-packages/sklearn/utils/validation.py:595: DataConversionWarning: Data with input dtype int8 was converted to float64 by StandardScaler.\n  warnings.warn(msg, DataConversionWarning)\n/opt/conda/envs/Python36/lib/python3.6/site-packages/sklearn/utils/validation.py:595: DataConversionWarning: Data with input dtype int8 was converted to float64 by StandardScaler.\n  warnings.warn(msg, DataConversionWarning)\n"
                },
                {
                    "data": {
                        "text/plain": "array([[ 1.15236718,  1.52797946, -1.21648407],\n       [-0.67488   , -0.67084969,  0.42978835],\n       [ 2.61416492,  1.25312582,  2.07606076],\n       ...,\n       [-0.67488   , -0.67084969,  0.42978835],\n       [-0.67488   , -0.67084969,  0.42978835],\n       [-0.67488   , -0.67084969,  0.97854582]])"
                    },
                    "execution_count": 13,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "from sklearn import preprocessing\nX = preprocessing.StandardScaler().fit(X).transform(X)\nX[0:]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Splitting Data"
        },
        {
            "cell_type": "code",
            "execution_count": 14,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Test set shape:  (34913, 3) (34913,)\nTraining set shape:  (81463, 3) (81463,)\n"
                }
            ],
            "source": "from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)\nprint('Test set shape: ', X_test.shape, y_test.shape)\nprint('Training set shape: ', X_train.shape, y_train.shape)"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "## Building Models"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### KNN"
        },
        {
            "cell_type": "code",
            "execution_count": 15,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([2, 1, 2, ..., 1, 1, 1])"
                    },
                    "execution_count": 15,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "from sklearn.neighbors import KNeighborsClassifier\nk = 24\n#Train Model and Predict  \nneigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)\nneigh_pred = neigh.predict(X_test)\nneigh_pred[0:]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### KNN Results"
        },
        {
            "cell_type": "code",
            "execution_count": 16,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "F1-Score of KNN is :  0.5056455410169037\nJaccard Score of KNN is :  0.5206083693753043\n"
                }
            ],
            "source": "from sklearn.metrics import f1_score, jaccard_similarity_score, log_loss\nprint(\"F1-Score of KNN is : \", f1_score(y_test, neigh_pred, average='macro'))\nprint(\"Jaccard Score of KNN is : \", jaccard_similarity_score(y_test, neigh_pred))"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### Decision Tree"
        },
        {
            "cell_type": "code",
            "execution_count": 17,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([2, 2, 2, ..., 2, 2, 1])"
                    },
                    "execution_count": 17,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "from sklearn.tree import DecisionTreeClassifier\ndt = DecisionTreeClassifier(criterion=\"entropy\", max_depth = 7)\ndt.fit(X_train, y_train)\npt = dt.predict(X_test)\npt[0:]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### Decision Tree Results"
        },
        {
            "cell_type": "code",
            "execution_count": 18,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "F1-Score of Decision Tree is :  0.542498614383236\nJaccard Score of Decision Tree is :  0.5632858820496663\n"
                }
            ],
            "source": "print(\"F1-Score of Decision Tree is : \", f1_score(y_test, pt, average='macro'))\nprint(\"Jaccard Score of Decision Tree is : \", jaccard_similarity_score(y_test, pt))"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### Logistic Regression"
        },
        {
            "cell_type": "code",
            "execution_count": 19,
            "metadata": {},
            "outputs": [
                {
                    "data": {
                        "text/plain": "array([2, 2, 2, ..., 1, 2, 1])"
                    },
                    "execution_count": 19,
                    "metadata": {},
                    "output_type": "execute_result"
                }
            ],
            "source": "from sklearn.linear_model import LogisticRegression\nLR = LogisticRegression(C=0.01, solver='liblinear').fit(X_train, y_train)\nLRpred = LR.predict(X_test)\nLRprob = LR.predict_proba(X_test)\nLRpred[0:]"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "### Logistic Regression Results"
        },
        {
            "cell_type": "code",
            "execution_count": 20,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "F1-Score of Logistic Regression is :  0.5190831572964161\nJaccard Score of Logistic Regression is :  0.5338412625669522\nLogLoss of Logistic Regression is :  0.6835463268902823\n"
                }
            ],
            "source": "print(\"F1-Score of Logistic Regression is : \", f1_score(y_test, LRpred, average='macro'))\nprint(\"Jaccard Score of Logistic Regression is : \", jaccard_similarity_score(y_test, LRpred))\nprint(\"LogLoss of Logistic Regression is : \", log_loss(y_test, LRprob))"
        },
        {
            "cell_type": "code",
            "execution_count": 21,
            "metadata": {},
            "outputs": [],
            "source": "from sklearn.metrics import classification_report, confusion_matrix\nimport itertools\nimport matplotlib.pyplot as plt\ndef plot_confusion_matrix(cm, classes,\n                          normalize=False,\n                          title='Confusion matrix',\n                          cmap=plt.cm.Blues):\n    \"\"\"\n    This function prints and plots the confusion matrix.\n    Normalization can be applied by setting `normalize=True`.\n    \"\"\"\n    if normalize:\n        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n        print(\"Normalized confusion matrix\")\n    else:\n        print('Confusion matrix, without normalization')\n\n    print(cm)\n\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(classes))\n    plt.xticks(tick_marks, classes, rotation=45)\n    plt.yticks(tick_marks, classes)\n\n    fmt = '.2f' if normalize else 'd'\n    thresh = cm.max() / 2.\n    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):\n        plt.text(j, i, format(cm[i, j], fmt),\n                 horizontalalignment=\"center\",\n                 color=\"white\" if cm[i, j] > thresh else \"black\")\n\n    plt.tight_layout()\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')"
        },
        {
            "cell_type": "code",
            "execution_count": 22,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "Confusion matrix, without normalization\n[[ 6261 11149]\n [ 5126 12377]]\n"
                },
                {
                    "data": {
                        "image/png": "iVBORw0KGgoAAAANSUhEUgAAAWUAAAEmCAYAAAC6SYF5AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAIABJREFUeJzt3XucXdP9//HXeyYXiYRE4hqXoKkiLSJ1/VYVjdBqUIpqhWq1/dILpUX1SxGl+mu/1K1USrVfQlqVujRCKVVRdxJE4hJCmosIkXtmPr8/9po4mcycc2ZyJucy72cf+zHnrL323uvs1GfWfM7aaykiMDOzylBX7gaYmdmHHJTNzCqIg7KZWQVxUDYzqyAOymZmFcRB2cysgjgoW9lI6iHpr5Lek3TbGpznWEn3lrJt5SLpU5KmlLsdVj7yOGUrRNKXgdOAjwELgGeAURHxzzU871eB7wB7RcSKNW5ohZMUwKCImFbutljlck/Z8pJ0GvC/wEXAxsCWwFXAiBKcfivg5c4QkIshqUu522AVICK8eWtxA9YHPgCOzFOnO1nQfjtt/wt0T/v2BWYAPwBmAzOBE9K+nwLLgOXpGicC5wF/yDn3QCCALun98cCrZL3114Bjc8r/mXPcXsDjwHvp5145+x4ELgAeSee5F+jfymdrav8Pc9p/KHAw8DIwDzg7p/5uwKPA/FT3CqBb2vdQ+iwL0+c9Kuf8PwL+A9zUVJaO2TZdY0h6vxkwF9i33P/f8NZxm3vKls+ewDrA7Xnq/BjYA9gZ2IksMJ2Ts38TsuA+gCzwXimpb0ScS9b7HhMRvSLi+nwNkbQucDlwUET0Jgu8z7RQbwPgrlS3H/BL4C5J/XKqfRk4AdgI6AacnufSm5DdgwHA/wDXAV8BdgU+BfyPpG1S3QbgVKA/2b3bH/hvgIjYJ9XZKX3eMTnn34Dsr4aTci8cEa+QBew/SuoJ/A64ISIezNNeq3IOypZPP2Bu5E8vHAucHxGzI2IOWQ/4qzn7l6f9yyPibrJe4nbtbE8jMFhSj4iYGRGTW6jzOWBqRNwUESsi4mbgJeCQnDq/i4iXI2IxcCvZL5TWLCfLny8HbiELuJdFxIJ0/cnAJwAi4smImJiu+zrwG+DTRXymcyNiaWrPKiLiOmAq8BiwKdkvQathDsqWzztA/wK5zs2A6Tnvp6eyledoFtQXAb3a2pCIWEj2J/+3gJmS7pL0sSLa09SmATnv/9OG9rwTEQ3pdVPQnJWzf3HT8ZI+KulOSf+R9D7ZXwL985wbYE5ELClQ5zpgMPDriFhaoK5VOQdly+dRYAlZHrU1b5P96d1ky1TWHguBnjnvN8ndGRHjI+KzZD3Gl8iCVaH2NLXprXa2qS2uJmvXoIhYDzgbUIFj8g5/ktSLLE9/PXBeSs9YDXNQtlZFxHtkedQrJR0qqaekrpIOkvTzVO1m4BxJG0rqn+r/oZ2XfAbYR9KWktYHzmraIWljSV9IueWlZGmQhhbOcTfwUUlfltRF0lHADsCd7WxTW/QG3gc+SL34bzfbPwvYZrWj8rsMeDIivk6WK79mjVtpFc1B2fKKiF+SjVE+B5gDvAmcAvwlVbkQeAJ4DngeeCqVtedaE4Ax6VxPsmogrSMbxfE22YiET5O+RGt2jneAz6e675CNnPh8RMxtT5va6HSyLxEXkPXixzTbfx5wo6T5kr5U6GSSRgDDyVI2kP07DJF0bMlabBXHD4+YmVUQ95TNzCqIg7KZWQVxUDYzqyAOymZmFcQToKwlfTfoHwO22LLczei0Xpoxv9xN6PQa5r02NyI2LMW56tfbKmLFag9AriYWzxkfEcNLcc21xUF5LRmwxZaM/dvD5W5Gp7XnD/9SuJJ1qPl/+ErzJy3bLVYspvt2BUcVsuSZKws9UVlxHJTNrPpIUFdf7lZ0CAdlM6tOqs2vxByUzaw6qdC0ItXJQdnMqpDTF2ZmlUPUbPqiNj+VmdU4ZemLQluhs0ijJc2WNCmn7FJJL0l6TtLtkvrk7DtL0jRJUyQdmFM+PJVNk3RmTvnWkh6TNFXSGEndCrXJQdnMqlNdfeGtsBvIZuLLNQEYHBGfIFuL8SwASTsARwM7pmOuklQvqR64EjiIbJrYY1JdgEuAX0XEIOBdsiXR8n+sYlptZlZZlKUvCm0FRMRDZFPB5pbdm7NazkRg8/R6BHBLWrrrNWAa2ZqUuwHTIuLViFhGtmzYCEkC9gPGpuNvJP+CEYCDsplVI1Fs+qK/pCdytpMKnLm5rwH3pNcDyOYTbzIjlbVW3g+YnxPgm8rz8hd9ZlaFBHVFha+5ETG0XVeQfgysAP744UVXE7TcuY089fNyUDaz6lTXceOUJY0kW8Fm//hwJZAZwBY51Tbnw/UoWyqfC/SR1CX1lnPrt8rpCzOrPk1D4tYwp9ziqaXhwI+AL0TEopxd44CjJXWXtDUwCPg38DgwKI206Eb2ZeC4FMwfAI5Ix48E7ih0ffeUzawKlebhEUk3A/uS5Z5nAOeSjbboDkzIvqtjYkR8KyImS7oVeIEsrXFyRDSk85wCjAfqgdERMTld4kfALZIuBJ4mW5U8LwdlM6tOJXjMOiKOaaG41cAZEaOAUS2U3022knrz8lfJRmcUzUHZzKpTjT7R56BsZtXHU3eamVUYzxJnZlYp5PSFmVnFEE5fmJlVDveUzcwqi3PKZmYVxOkLM7MKIacvzMwqi9MXZmaVQUBdnXvKZmaVQbQ8W3ENcFA2syok5PSFmVnlcPrCzKyCuKdsZlYpnFM2M6scQk5fmJlVklpNX9Tmrxozq3mSCm5FnGO0pNmSJuWUHSlpsqRGSUOb1T9L0jRJUyQdmFM+PJVNk3RmTvnWkh6TNFXSmLSwal4OymZWfQSqU8GtCDcAw5uVTQIOBx5a5ZLSDmQrVe+YjrlKUr2keuBK4CBgB+CYVBfgEuBXETEIeBc4sVCDHJTNrOqIwr3kYnrKEfEQMK9Z2YsRMaWF6iOAWyJiaUS8BkwjWxR1N2BaRLwaEcuAW4ARyhqwHzA2HX8jcGihNjmnbGZVqciccn9JT+S8vzYirm3nJQcAE3Pez0hlAG82K98d6AfMj4gVLdRvlYOymVWflL4owtyIGFq4WrFXXU3QcsYh8tTPy0HZzKpSGUZfzAC2yHm/OfB2et1S+Vygj6QuqbecW79VzimbWVUqRU65jcYBR0vqLmlrYBDwb+BxYFAaadGN7MvAcRERwAPAEen4kcAdhS7innInVifYZP3udO+a/W6eOX8pvdepp9c6XYiA5Q2NzJy/lMb0B1f3LmKT9btTJxHA9LmLCaB/766s36ML9RIvz1pUts9TDX799T04cJcBzH1/CXuddRcAI3bbkh8d9nG222x99j/vbzzzWva9U99e3bjxO59il236cfPDr/LD3z+x2vn+79RPM3CjXivPNXjLPvy/43ej1zpdeWPuB5x01SMsWLJiteOqnSh6dEX+80g3A/uS5Z5nAOeSffH3a2BD4C5Jz0TEgRExWdKtwAvACuDkiGhI5zkFGA/UA6MjYnK6xI+AWyRdCDwNXF+oTQ7KndjG63Vj4dIG3p6/FMiC9MKlYs6CxQBs2Lsr/Xp1Zc6C5QBs2mcdZs5fytIVjdTpw+TYB0saeHfhCrbdsEc5PkZVufnhV7luwhSu+dZeK8tenDGf4y57iF99bfdV6i5d3sBFf3qO7Tfvw/abr7/auT4/dAsWNgu4l524Bz+5+Sn+9dJsjt1nG77zuR246E/PdcyHKSeVJn0REce0suv2VuqPAka1UH43cHcL5a+Sjc4omtMXnVSdoEe3et5b/OF/1I0Bi5Y1rHy/eFkjXeqz/4us272epSsaWbqicWXdJkuWN9LQWPD7CwP+NWU27y5ctkrZy2+/z7T/LFit7qKlDUx8eQ5Lljestm/d7l04efjH+MUdz69S/pFN1+NfL80G4MFJ/+GQT25ZwtZXljKkL9YKB+VOqmt9HQ2Nwabrd2Ng/3XYZP1uq62u06dnFxYuzYJ2t/qsa7z5Bt0Z2H8dNli3axlabU3OPuITXHHPi6v8EgV4acZ8DhqyOZClRQZs0LMczVsrSvTwSMXp0KAs6cfpccXnJD0jaXdJD6bHEZ9J21hJ+0p6tNmxXSTNkrSppBskvZZzzL9SneMlzUllL0k6Nef48ySdLunKtP8FSYtzzvFDSWNy6q8n6ZWUwC/0ufpJekDSB5KuKOU9W1skWKdrHe8uWsHrc5fQGNAvJ9D269WVAN5f3LCyfo9udcx8dynT5y6h9zr19Ozm3+nlMHjLvmyzcW/uenLGavtOuW4iXz/gozxw/nB69ejK8vSXTS2q1Z5yh+WUJe0JfB4YEhFLJfUHmp77PjYinsipWwdsLmlgRLyeig8AJkXEzHRzz4iIsaxuTEScIqkfMEXS2IhYOZA7Ik5O1xgI3BkRO6f3Av4p6YCIuA84nyxB/1oRH28J8BNgcNqqzvKGYEVDsGR59h/tgsUr6NcrC8rr9ehCr+71vPHOklXqL17WQEPKUnywtIF1utazaFnt/kdfqXYb1J+dBm7As78cQX19HRuu152/nn0Ah1x0H1Nnvs8Xf/53ALbdpDfDdtqszK3tGNUcdAvpyC/6NiUbuL0UICLmQsvJ+YholHQbcBTZs+KQDSu5udiLRcQ7kqal675ZRP2Q9G3g/yQdD+wP7FrktRaSBfSPFNu+StPQGCxvDLrVi2UNsTJnvG73evqt25U35i1eZZT7wqUN9OvVFZF9wdezWz3zFi4vU+s7t9H3T2X0/VMB2KL/uoz5wb4cctF9APRfrztz31+KBKePGMzv/j61nE3tUJ66s+3uBf5H0svAfWQ92n+kfX+UtDi9nhARZ5AF4GuBSyR1Bw4GTs0536WSzkmvJ0fEsbkXk7QlsA5Q9FfNEfGcpPHA/cCh6bl1JJ0BHNvCIQ9FxHeLPb+kk4CTADYbsEWB2mvfrPeWsWmf7khaOfxtYP8eSLDFBusA2Zd9s95fRmPAvIXLGdg/G2HxwdIVLFyapTY27N2V9Xp0QYJtN+rBe4tWMPcDB+yW/Pa/92bv7TemX6/uTLrsMC7+83O8+8FSLjnuk/Tv3Z0xP9iX56e/yxGXPgDAs78cQe8eXenapY6Dd92CL15yP1Pefr/V839xj4F8/YCPAnDnE2/yx4deXSufqyxqs6PccUE5Ij6QtCvwKeAzwBh9OKXdKumLVP9xSb0kbQdsD0yMiHdzqrSWvjhK0meA7YBvRMSSFurkcyVwUEQ8kNOWS4FL23ie1aRn7K8FGLzTkIobnrB0RSPT31n1dr06Z3ErtbP88vuLV98/Z8HylcPmLL+vX/VIi+Ut5YcBdjot/7MGb85duHKMMsBv7p3Cb+5taS6d2uP0RTukgdUPAg9Kep7siZZ8biFLW2xP8amLppzynmQDve+JiP+0oZmNaVupVD1lM+sgJRqnXIk68ou+7YDGiGhKau0MTCf/F2M3kz2GuD5FzDuaKyIelXQT8D3grLa3eJVzlaSnbGYdI1sOykG5rXoBv5bUh+yRxGlk+dWxrJpTnhsRBwBExAuSFgFPpi/TcuXmlKHlp2QuAZ6SdFEpP0hLJL0OrAd0k3QoMCwiXujo65pZpkY7yh2aU34S2KuFXfsWOG6nFsqOb6X6DWlrqvc2sEl6e16zc7xOC7301soLiYiBbT3GzErH6QszswohQX29g7KZWcWo0Y6yg7KZVSenL8zMKoSER1+YmVUOz31hZlZRajQmez5lM6tCKX1RaCt4Gmm0pNmSJuWUbSBpgqSp6WffVC5Jl0ualqYjHpJzzMhUf6qkkTnlu0p6Ph1zuYro3jsom1nVESWbT/kGYHizsjOB+yNiENlkZU1z9hxEtljqILIH4a4ma8cGZGv77U72UNu5TYE81Tkp57jm11qNg7KZVSWp8FZIRDxEtlBqrhHAjen1jcChOeW/j8xEoI+kTYEDyWa7nJcmUZsADE/71ouIR9PK1r/POVernFM2s6pU5OiL/pJyZ6S8Ns3emM/GETETIC2ysVEqH8Cqc7XPSGX5yme0UJ6Xg7KZVZ/iZ4mbGxFDS3fV1UQ7yvNy+sLMqk6WU17z9EUrZqXUA+nn7FQ+A8hdrWJz4O0C5Zu3UJ6Xg7KZVaHCIy/W4OGScXw49/tIsumEm8qPS6Mw9gDeS2mO8cAwSX3TF3zDgPFp3wJJe6RRF8flnKtVTl+YWVUqxcMjkm4mm7myv6QZZKMoLgZulXQi8AZwZKp+N9kyddOARcAJABExT9IFwOOp3vkR0fTl4bfJRnj0AO5JW14OymZWfdYsPbFSRBzTyq79W6gbwMmtnGc0MLqF8ido49TADspmVnWEV7M2M6sotfqYtYOymVUlT0hkZlYhpE64cKqk9fIdGBHvl745ZmbFqdGOct6e8mRWfyql6X0AW3Zgu8zM8qqr0ajcalCOiC1a22dmVk61vPJIUWNKJB0t6ez0enNJu3Zss8zM8qtT4a0aFQzKkq4APgN8NRUtAq7pyEaZmRVSovmUK04xoy/2ioghkp6GlY8UduvgdpmZtUp0wpxyjuWS6khTzknqBzR2aKvMzAqo1vREIcXklK8E/gRsKOmnwD+BSzq0VWZm+RSRuqjZ9EVE/F7Sk8ABqejIiJiU7xgzs44koL5Gu8rFPtFXDywnS2HU5iwgZlZVqrQjXFAxoy9+DNwMbEY2c/7/STqroxtmZpZPp01fAF8Bdo2IRQCSRgFPAj/ryIaZmbVG6tzpi+nN6nUBXu2Y5piZFac2Q3L+CYl+RZZDXgRMljQ+vR9GNgLDzKxsqjU9UUi+nnLTCIvJwF055RM7rjlmZoVJKln6QtL3gG+Qdb6vi4j/lbQBMAYYCLwOfCki3k0LoF5GtlbfIuD4iHgqnWckcE467YURcWN72pNvQqLr23NCM7O1oRQdZUmDyQLybsAy4G+S7kpl90fExZLOBM4EfgQcBAxK2+7A1cDuKYifCwwlyyg8KWlcRLzb1jYVM/piW0m3SHpO0stNW1svZGZWSiUafbE9MDEiFkXECuAfwGHACKCpp3sjcGh6PQL4fWQmAn0kbQocCEyIiHkpEE8AhrfncxUz5vgG4HdkXfuDgFuBW9pzMTOzUmh6eKTQBvSX9ETOdlKzU00C9pHUT1JPsrTEFsDGETETIP3cKNUfALyZc/yMVNZaeZsVM/qiZ0SMl/SLiHgFOEfSw+25mJlZqRSZvZgbEUNb2xkRL0q6hKxn+wHwLLCijZdtvhhIbnmbFdNTXpqS269I+pakQ/jwt4aZ2VonZbPEFdqKERHXR8SQiNgHmAdMBWaltATp5+xUfQZZT7rJ5sDbecrbrJigfCrQC/gusDdZAvxr7bmYmVmp1NWp4FYMSRuln1sCh5M9wTwOGJmqjATuSK/HAccpswfwXkpvjAeGSeorqS/Z0OHx7flcxUxI9Fh6uYAPJ7o3MyurEg5T/lOakng5cHIa+nYxcKukE4E3gCNT3bvJ8s7TyIbEnQAr55m/AHg81Ts/Iua1pzH5Hh65nTw5kYg4vD0XNDNbU6L49EQhEfGpFsreAfZvoTyAk1s5z2hg9Jq2J19P+Yo1Pbl9qHuXOgZuuG65m9FpLZn0aLmbYKVUwwun5nt45P612RAzs7ao1TmEi51P2cysYojOOfeFmVnF6lKjXeWig7Kk7hGxtCMbY2ZWDKl2e8rFzH2xm6TnyQZUI2knSb/u8JaZmeVRp8JbNSrmD4DLgc8D7wBExLPAZzqyUWZm+bRh7ouqU0z6oi4ipjf7U6Ghg9pjZlaUGk0pFxWU35S0GxCS6oHvAJ6608zKqkZTykUF5W+TpTC2BGYB96UyM7OyKOXKI5WmmLkvZgNHr4W2mJkVrUZjcuGgLOk6WpgDIyKaTxZtZrZWCEo290WlKSZ9cV/O63XIlkp5s5W6ZmYdT1Bfo9/0FZO+GJP7XtJNZLP0m5mVjYpde6TKtOcx662BrUrdEDOzYmXpi3K3omMUk1N+lw9zynVky6Wc2ZGNMjMrpFOOvkhr8+0EvJWKGtMkz2ZmZVPLPeW8qfIUgG+PiIa0OSCbWfmpaVKi/FtRp5JOlTRZ0iRJN0taR9LWkh6TNFXSGEndUt3u6f20tH9gznnOSuVTJB3Y3o9WzPeX/5Y0pL0XMDMrNQFd6lRwK3geaQDZotBDI2IwUE/2XMYlwK8iYhDwLnBiOuRE4N2I+Ajwq1QPSTuk43YEhgNXpSeg26zVoCypKbXxX2SBeYqkpyQ9Lemp9lzMzKxUStVTJkvj9kgxrycwE9gPGJv23wgcml6PSO9J+/dPad4RwC0RsTQiXiNbWHW39nyufDnlfwNDchpjZlYhRF0JhsRFxFuSfkG2YvVi4F7gSWB+RKxI1WYAA9LrAaTnNCJihaT3gH6pfGLOqXOPaZN8QVnpwq+058RmZh1FxT880l/SEznvr42Iaz88j/qS9XK3BuYDtwEHtXCepu/TWvpNEHnK2yxfUN5Q0mmt7YyIX7bngmZmpVDkY9ZzI2Jonv0HAK9FxBwASX8G9gL6SOqSesubA2+n+jOALYAZKd2xPtkw4abyJrnHtEm+3zX1QC+gdyubmVlZZAunliSn/Aawh6SeKTe8P/AC8ABwRKozErgjvR6X3pP2/z2NShsHHJ1GZ2wNDCJLAbdZvp7yzIg4vz0nNTPraKV4eCQiHpM0FngKWAE8DVwL3AXcIunCVHZ9OuR64CZJ08h6yEen80yWdCtZQF8BnBwR7VoMpGBO2cys0ojSrTwSEecC5zYrfpUWRk9ExBLgyFbOMwoYtabtyReU91/Tk5uZdYgaXs261aAcEfPWZkPMzIoloL6zBWUzs0pWmyHZQdnMqlSNdpQdlM2s+gg5fWFmVkk63Rd9ZmaVrDZDsoOymVUhyaMvzMwqitMXZmYVpDZDsoOymVUhPzxiZlZhajQmOyibWTUSqtEEhoOymVUdpy/MzCpJ2xZGrSoOyp3Ydh8ZSO9evamvr6dLly488tgT/GnsbYy64DxeevFFHv7Xv9l1aLaSzv33TeAnZ5/JsmXL6NatGxddcin7fmY/AJYtW8ap3z2Fhx56kLq6Os47fxSHHf7Fcn60inXNucdy0D6DmTNvAUOPvAiAi75/KAfvM5hlyxt4bcZcTjr3D7z3wWKG7rgVV/zkGCALQKOuuZtxDzzHoK024qZLvrbynFsP6McFV9/FFf/3IDddfAKDBm4MQJ/ePZi/YDF7HH3xWv+ca4ODstWkv933AP3791/5fscdB3PLrX/mlP/+5ir1+vXrz9i//JXNNtuMyZMmccjnDuTV6W8BcMnPRrHhRhvx/Asv09jYyLx5nvW1NTf9dSLXjPkHv73guJVl9098iZ/8ehwNDY1c+N0RnPG1YZxz+R1MfuVt9j725zQ0NLJJ//V4bMxZ3PXQJKZOn70y0NbViVfGj2LcA88C8NUzf7fyvBefdhjvfbB47X7AtcTpC+s0Prb99i2W77zLLitf77DjjixdsoSlS5fSvXt3brxhNM9OegmAurq6VYK8reqRp15hy003WKXs/okvrXz97+df47ADsnu9eMnyleXdu3UlWwpuVZ/ZbTtemzGHN2a+u9q+L352CMO/eXmpml5xavWLvlKtqGJVSBKHHDSMvXbbleuvu7bwAcntf/4TO+28C927d2f+/PkA/PTcn7DnJ4fw5aOPZNasWR3V5Jp33Ig9Gf/ICyvff3LwVjw59sc8cdvZfHfULTQ0NK5S/8gDd+XWvz252nn2HrIts+Yt4JU35nR4m8ulFAunStpO0jM52/uSvi9pA0kTJE1NP/um+pJ0uaRpkp6TNCTnXCNT/amSRrZ+1fw6NChL+rGkyanxz0jaXdKDkqbk3ISxkvaV9GizY7tImiVpU0k3SHot55h/pTrHS5qTyl6SdGrO8edJOl3SlWn/C5IW55zjh5LG5NRfT9IraSXaQp/rs5KelPR8+rlfKe/b2vL3fzzCo48/xV/uvIffXH0l/3z4oYLHvDB5Muec/SOuuOo3AKxYsYK3Zsxgz7325tHHn2L33ffkrB+e3tFNr0k/PPFAGhoaueXux1eWPT5pOrseMYr/+srPOeNrw+je7cM/brt2qedzn/44f57w9Grn+tLwodz2tyfWSrvLoSl9UWgrJCKmRMTOEbEzsCuwCLgdOBO4PyIGAfen9wAHka1UPQg4CbgaQNIGZOv87U62tt+5TYG8rTosKEvaE/g8MCQiPgEcALyZdh/bdCMi4gjgIWBzSQNzTnEAMCkiZqb3Z+Qcs1dOvTHphu4N/FjSFrntiIiT0/6DgVdy/gEuTdc8IFU9HxgdEa8V8fHmAodExMfJlhu/qYhjKs5mm20GwEYbbcQXDj2Mxx/PvyL6jBkzOOrIw/jt6N+zzbbbAtCvXz969uzJiEMPA+DwI47kmWee6tiG16BjD9mdg/cZzPE/vqHF/VNem8XCxcvY8SObrSw78L924JmX3mT2vAWr1K2vr2PEfjsxdnwt/zuoqP+10f5kMWI6MAK4MZXfCByaXo8Afh+ZiUAfSZsCBwITImJeRLwLTACGt+eTdWRPeVNgbkQsBYiIuRHxdksVI6IRuA04Kqf4aODmYi8WEe8A09J1i6kfwLeB/5U0lOwf5NIij30657NMBtaR1L3YtlaChQsXsmDBgpWv75twLzvuOLjV+vPnz+fwL3yO8y/8GXvtvffKckkc/PlDeOgfDwLw4N/v52Pb79Chba81n91re35w/AEc8f3frJJH3mqzftTXZ/+JbrlpXz46cGOmv/3Oyv1fGj60xdTFfrtvx8uvz+Kt2fM7vvHlUkTqInWU+0t6Imc7Kc9Zc2POxk0dwvRzo1Q+gA87lwAzUllr5W3WkV/03Qv8j6SXgfvIerT/SPv+KKnpa+EJEXEG2c24FrgkBbiDgVNzzneppHPS68kRcWzuxSRtCawDPFdsAyPiOUnjyf48OTQilqVznQEc28IhD0XEd5uVfRF4uumXT7WYPWsWRx2R9W5XNKzgqKO/zLADh3PHX27ntO9/h7lz5nD4iM/xiZ125q93j+eaq67glVemcfGoC7h41AUA/PWee9loo4248KJLOPH4r3LGad+gWBT5AAAQHUlEQVSn/4Yb8pvf/i7fpTu1G392PJ/adRD9+/Ri2t8u4IJr7uaME7K0xJ1XnwLAv59/ne+OuoW9dtmG008YxvIVDTQ2Bt+7aAzvzF8IQI91urLf7h/jlAtX77e0lmeuJW0YfTE3IoYWPJ/UDfgCcFYRl24u8pS3mVr6RrdUJNUDnwI+A3yTLC9zPHB6RKyW8JI0lSzlsT3wtYj4Qiq/AbgzIsY2q388We92NrAd8I2I+F3adx7wQUT8Ir0fmM4xuNk5tknlbe7eSdoRGAcMi4hXWth/ElneiS223HLXl1+Z3tZLWIn0/eQp5W5Cp7fkmSufLCZAFmP7j+8Sv7v9gYL19hzUt6hrShoBnBwRw9L7KcC+ETEzpScejIjtJP0mvb45t17TFhHfTOWr1GuLDv2iLyIaIuLBiDgXOIWsV5nPLWR/QrQldTEmInYkC/7/T9ImbWxmY9pWknRGs29km7bLc+psTvaFwHEtBWSAiLg2IoZGxNAN+2/YxmaZWV4qYiveMawac8aRfV9E+nlHTvlxaRTGHsB7Kb0xHhgmqW/6gm9YKmuzDktfSNoOaIyIqaloZ2A60HriMrspdwDrAye25XoR8aikm4DvUfhPkELnupQ8+WVJfYC7gLMi4pE1uZaZtU9diR4ekdQT+CzZX/NNLgZulXQi8AZwZCq/myy1Oo1spMYJABExT9IFQNPQmfMjol1PUXVkTrkX8OsUwFaQfYiTgLGsmlOeGxEHAETEC5IWAU9GxMJm58vNKUM27KS5S4CnJF1Uyg/SglOAjwA/kfSTVDYsImZ38HXNLCnVoyMRsQjo16zsHbIv/5vXDeDkVs4zGhi9pu3psKAcEU8Ce7Wwa98Cx+3UQtnxrVS/IW1N9d4GmtIX5zU7x+u00EtvrbxAGy8ELmzLMWZWYrX5QJ8fszaz6iOVLn1RaRyUzawq1WZIdlA2s2pVo1HZQdnMqpCcvjAzqxRtH4ZcPRyUzaw61WhUdlA2s6rk9IWZWQWpzZDsoGxm1aiGk8oOymZWdYTTF2ZmFaU2Q7KDsplVqxqNyg7KZlaVnL4wM6sgtRmSHZTNrFrVaFR2UDazqlPLU3d26Bp9ZmYdpVRL9EnqI2mspJckvShpT0kbSJogaWr62TfVlaTLJU2T9JykITnnGZnqT5U0svUr5uegbGbVqXQLp14G/C0iPgbsBLwInAncHxGDgPvTe4CDgEFpOwm4GkDSBsC5wO5kS9Wd2xTI28pB2cyqUDZ1Z6Gt4Fmk9YB9gOsBImJZRMwHRgA3pmo3Aoem1yOA30dmItBH0qbAgcCEiJgXEe8CE4Dh7flkDspmVnWK6SQX2VHeBpgD/E7S05J+K2ldYOOImAmQfm6U6g8A3sw5fkYqa628zRyUzaw6FReV+0t6Imc7qdlZugBDgKsjYhdgIR+mKlq7anORp7zNPPrCzKqSiusLz42IoXn2zwBmRMRj6f1YsqA8S9KmETEzpSdm59TfIuf4zYG3U/m+zcofLKaBzbmnbGZVqU6Ft0Ii4j/Am5K2S0X7Ay8A44CmERQjgTvS63HAcWkUxh7Aeym9MR4YJqlv+oJvWCprM/eUzaz6KBurXCLfAf4oqRvwKnACWYf1VkknAm8AR6a6dwMHA9OARakuETFP0gXA46ne+RExrz2NcVA2sypVmqgcEc8ALaU49m+hbgAnt3Ke0cDoNW2Pg7KZVZ1sPuVyt6JjOCibWVWq0aesHZTNrDoVOfqi6jgom1lVck/ZzKxCqLSjLyqKg7KZVSWnL8zMKoh7ymZmFcRB2cysYsjpCzOzSiHcUzYzqygOymZmFcTpCzOzCqEip+asRg7KZladHJTNzCqH0xdmZhXE6Qszs0rioGxmVjlqNX2hbHUT62iS5gDTy92ONdAfmFvuRnRy1f5vsFVEbFiKE0n6G9n9KGRuRAwvxTXXFgdlK4qkJwos1W4dzP8GnUNduRtgZmYfclA2M6sgDspWrGvL3QDzv0Fn4JyymVkFcU/ZzKyCOCibmVUQB2UzswrioGxrhZRNSS7J/58rA0nrSupd7nZYYf4PxDqcpH2B0yT1jIhGB+a1S9LngD8Bd0k6rdztsfw894V1qBSQ7wHuBHpI+mVELJJUFxGN5W1d7ZM0DLgE+A7wPnCHpBkRcWt5W2atcY/FOlpP4GzgMmBD4AfuMa8dkroDQ4GfRMQDEfEkcA6weXlbZvl4nLJ1OEldImKFpM8CBwPzgV9ExEJJXSNieZmbWLMkfRSYHRHz0/vjgcMj4gtlbZi1yukL6zCSFJkVqejvZH+dHQScIKlLqndZuHfQISLiZci+YE3poteARalsJLAiIv5YxiZaMw7K1iEk1UdEg6T1gIUR0ZDe3wfMBK4EdgD2d0AuvZbuf9o1A3hL0tHA6cAxZWuktcg5PSu5nICwBXAz8LGmfSk47AVsD3wqIp4pUzNrVr77D6wHnAqcBRwZEZPK0UZrnYOylVROQNgcuA0YDSyQdHJOtelkPeQXytLIGpbn/p+Sxoq/RTY87qiIeKmcbbWWOSjbGpNUn352yQkItwI/B54C7gCmNtWPiHsi4tmyNLYGFXn/X075/dnAiQ7IlctB2daIpD2A6wDSCItNgHHAL4CnyXpr50bEveVrZe1qy/1vCt4R8X652muF+Ys+W1OvARtIWhdYCgwnG5f8MjAWOC8i/lrG9tW6ou9/zpd9VsEclK0UNgI+EhHPSvoDsC7wB+ACB+S1wve/hjh9YW0maUdJl0naGRAwBtg67W4EVgCnRcRfmiYistLx/a9tfqLP2iQ9lbcbsAHQB9gd6AVMiYgDy9m2zsD3v/Y5KFvR0uQ2lwLfjIiJqWxTsl7ad4GlETEylXvCoRLz/e8cnL6wokg6kOxb/T9GxERJXdIQrJkR8S/gFKCnpD8DOCCUlu9/5+GgbAXl9NB+CRwhaXiaz2Llt/kRMRc4GVgoabPytLQ2+f53Lh59YXlJGgQcRfYn86OSJgOXSmpMY18F0PRggqSR7qWVju9/5+OcsrVK0rZkE9a8EBF/zik/hmws7A+aB4bytLQ2+f53Tu4pWz7dgN7AJyXNiYiHASLi5hQHLpbULSLuLGcja5jvfyfknrKtJk33uCQilknaBhgJdAfuagoMqd4JwNeBYcAi99RKw/e/c3NQtlVI+jxwEtCXbBmhB9PqFcfScmBYz3MplI7vvzko20qSDgYuAP4bOBD4LPDViHg9JzB0Be6LiL+Xr6W1yfffwEPiLJG0MVlA+GdEPBYR5wMPAwemvOXLwLVkec59JPUoY3Nrju+/NXFP2ZA0ICLeSmu27QI8FxGjJd0CbEq2CvVlwCvAE0DXiJhTvhbXFt9/y+Wecicn6SBggqS+wJ3Av4Hd0lp6fcmGZF1NNhPZlWS/yB0QSsT335pzT7kTkzQc+ClwdkTcn8oEHE2W17whIq7Pqd89IpaWpbE1yPffWuKecieVVqy4GrgwIu6XtJWk24HNgLvSvp0kfS/nsGVlaGpN8v231jgod0KSegEbAy8Bb0jakWxS9L9HxFtpiNU9ZMsJbSNpffATY6Xi+2/5OH3RiaQ/jbcB7gb2JHvo4AvAEGB0RPw8p+7ANBTL42BLxPffiuGecieSJq15hWyo1UkRcQvZn8pTgCcl9QaQdBzpyycHhNLx/bdieO6LTiSNd11G9i3/oQAR8cf05/FXgQZJ2wHHAYdGxLvla23t8f23Yjh90QlI+jgwLSIWp/fdgUeAeyPi7FR2EnAkMAA4MiIml6u9tcb339rC6Ysal54U+wbwlKSDJA1Ow6q+CQyQtANARFwLXAN8zgGhdHz/ra2cvqhhacWKL5EFgO8BBwFDJY0GHiP7pbw58AJARPypTE2tSb7/1h5OX9QoZWu6XQycnvNgQhdgP+A84D7ga8AHwGciYmaZmlqTfP+tvdxTrkGSDiBbz+2UiHhA0lZk+cqr0koVk4CBZKsg70zOWm+25nz/bU24p1xjJPUBriebJP1YSVsCtwG/jYjrJCn3IQRJG3ouhdLx/bc15aBcQ9IE6UPI/jQ+m2xWsb2AGyPiipx660bEwvK0snb5/lspePRFjUgBYRTZIpv/Ak4ke5R3JnBVTr2RwG9TftNKxPffSsVBuQZI2gT4AfD1iBgrqWdEzCLLa/YCvqfMscC3gVERsaKMTa4pvv9WSv5tXRuWAsuBJZLWAX4oaV/gHaAR+CKwD9mXS8dGxAtlamet8v23knFOuQakiW5OI5vgZkeynOY/gReBw4BXyVa0+GVEvFiudtYq338rJQflGpGmg/w4sAVwR9Nk6JJuBG6LiDvL2b5a5/tvpeKgXMMkHQmcCRwVEdPK3Z7Oxvff2sM55RokaVPgKLI5FxwQ1jLff1sT7inXIGXLz+8HTHFAWPt8/21NOCibmVUQj1M2M6sgDspmZhXEQdnMrII4KJuZVRAHZTOzCuKgbB1CUoOkZyRNknSbpJ5rcK59Jd2ZXn9B0pl56vaR9N/tuMZ5kk4vtrxZnRskHdGGaw1ME92brcZB2TrK4ojYOSIGA8uAb+XuTLOmtfn/fxExLiIuzlOlD9DmoGxWKRyUbW14GPhI6iG+KOkq4ClgC0nDJD0q6anUo+4FIGm4pJck/RM4vOlEko6XdEV6vbGk2yU9m7a9yNbF2zb10i9N9c6Q9Lik5yT9NOdcP5Y0RdJ9wHaFPoSkb6TzPCvpT816/wdIeljSy2luZSTVS7o059rfXNMbabXPQdk6VJrM/SDg+VS0HfD7iNgFWAicAxwQEUOAJ4DT0vSX1wGHAJ8CNmnl9JcD/4iInchW/JhMNtfEK6mXfoayFaUHAbuRrYe3q6R9JO0KHE02e9vhwCeL+Dh/johPpuu9SDaRfZOBwKeBzwHXpM9wIvBeRHwynf8bkrYu4jrWiXnuC+soPSQ9k14/TLZu3WbA9IiYmMr3AHYAHslmv6Qb8CjwMeC1iJgKIOkPwEktXGM/4DiAiGgA3pPUt1mdYWl7Or3vRRakewO3R8SidI1xRXymwZIuJEuR9ALG5+y7NSIagamSXk2fYRjwiZx88/rp2i8XcS3rpByUraMsjoidcwtS4M1dm07AhIg4plm9nYFSPf8v4GcR8Ztm1/h+O65xA3BoRDwr6Xhg35x9zc8V6drfiYjc4I2kgW28rnUiTl9YOU0E9pb0EQBJPSV9FHgJ2FrStqneMa0cfz/Z8kpN+dv1gAVkveAm44Gv5eSqB0jaCHgIOExSD0m9yVIlhfQGZkrqChzbbN+RkupSm7cBpqRrfzvVR9JHJa1bxHWsE3NP2comIuakHufNkrqn4nMi4mVJJwF3SZpLtorH4BZO8T3gWkknAg3AtyPiUUmPpCFn96S88vbAo6mn/gHwlYh4StIY4BlgOlmKpZCfAI+l+s+zavCfAvyDbLHUb0XEEkm/Jcs1P5VWJ5kDHFrc3bHOyrPEmZlVEKcvzMwqiIOymVkFcVA2M6sgDspmZhXEQdnMrII4KJuZVRAHZTOzCvL/Aeup7rWal49RAAAAAElFTkSuQmCC\n",
                        "text/plain": "<Figure size 432x288 with 2 Axes>"
                    },
                    "metadata": {
                        "needs_background": "light"
                    },
                    "output_type": "display_data"
                }
            ],
            "source": "# Compute confusion matrix\ncnf_matrix = confusion_matrix(y_test, LRpred, labels=[1,2])\nnp.set_printoptions(precision=2)\n\n# Plot non-normalized confusion matrix\nplt.figure()\nplot_confusion_matrix(cnf_matrix, classes=['SEVERITY=1','SEVERITY=2'],normalize= False,  title='Confusion matrix')"
        },
        {
            "cell_type": "code",
            "execution_count": 23,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "              precision    recall  f1-score   support\n\n           1       0.55      0.36      0.43     17410\n           2       0.53      0.71      0.60     17503\n\n   micro avg       0.53      0.53      0.53     34913\n   macro avg       0.54      0.53      0.52     34913\nweighted avg       0.54      0.53      0.52     34913\n\n"
                }
            ],
            "source": "print (classification_report(y_test, LRpred))"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": ""
        }
    ],
    "metadata": {
        "kernelspec": {
            "display_name": "Python 3.6",
            "language": "python",
            "name": "python3"
        },
        "language_info": {
            "codemirror_mode": {
                "name": "ipython",
                "version": 3
            },
            "file_extension": ".py",
            "mimetype": "text/x-python",
            "name": "python",
            "nbconvert_exporter": "python",
            "pygments_lexer": "ipython3",
            "version": "3.6.9"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 1
}
